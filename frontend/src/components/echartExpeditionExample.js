const rawData = [
    {
        "id": 13,
        "Site": "djibouti_maskali",
        "Site_name": "djibouti_maskali_buoy_air_france",
        "ID_site": "djibouti_maskali_buoy_air_france_13",
        "year": 2022,
        "Date": "9/26/22",
        "date_iso": "2022-09-26",
        "country": "djibouti",
        "latitude_begin": 11.73536667,
        "longitude_begin": 43.16748333,
        "latitude_end": 11.73623333,
        "longitude_end": 43.16751667,
        "Substrate_1": "sand",
        "Substrate_2": "sand",
        "Substrate_3": "sand",
        "mean": 0.004730464
    },
    {
        "id": 13,
        "Site": "djibouti_maskali",
        "Site_name": "djibouti_maskali_buoy_air_france",
        "ID_site": "djibouti_maskali_buoy_air_france_13",
        "year": 2022,
        "Date": "9/26/22",
        "date_iso": "2022-09-26",
        "country": "djibouti",
        "latitude_begin": 11.73536667,
        "longitude_begin": 43.16748333,
        "latitude_end": 11.73623333,
        "longitude_end": 43.16751667,
        "Substrate_1": "rubble",
        "Substrate_2": "rubble",
        "Substrate_3": "rubble",
        "mean": 0.012057567
    },
    {
        "id": 13,
        "Site": "djibouti_maskali",
        "Site_name": "djibouti_maskali_buoy_air_france",
        "ID_site": "djibouti_maskali_buoy_air_france_13",
        "year": 2022,
        "Date": "9/26/22",
        "date_iso": "2022-09-26",
        "country": "djibouti",
        "latitude_begin": 11.73536667,
        "longitude_begin": 43.16748333,
        "latitude_end": 11.73623333,
        "longitude_end": 43.16751667,
        "Substrate_1": "unknown_hard_substrate",
        "Substrate_2": "unknown_hard_substrate",
        "Substrate_3": "unknown_hard_substrate",
        "mean": 0.089592159
    },
    {
        "id": 13,
        "Site": "djibouti_maskali",
        "Site_name": "djibouti_maskali_buoy_air_france",
        "ID_site": "djibouti_maskali_buoy_air_france_13",
        "year": 2022,
        "Date": "9/26/22",
        "date_iso": "2022-09-26",
        "country": "djibouti",
        "latitude_begin": 11.73536667,
        "longitude_begin": 43.16748333,
        "latitude_end": 11.73623333,
        "longitude_end": 43.16751667,
        "Substrate_1": "algae_covered_substrate",
        "Substrate_2": "algae_covered_substrate",
        "Substrate_3": "algae_covered_substrate",
        "mean": 0.733245303
    },
    {
        "id": 13,
        "Site": "djibouti_maskali",
        "Site_name": "djibouti_maskali_buoy_air_france",
        "ID_site": "djibouti_maskali_buoy_air_france_13",
        "year": 2022,
        "Date": "9/26/22",
        "date_iso": "2022-09-26",
        "country": "djibouti",
        "latitude_begin": 11.73536667,
        "longitude_begin": 43.16748333,
        "latitude_end": 11.73623333,
        "longitude_end": 43.16751667,
        "Substrate_1": "coral_bleached",
        "Substrate_2": "branching_bleached",
        "Substrate_3": "branching_bleached",
        "mean": 0
    },
    {
        "id": 13,
        "Site": "djibouti_maskali",
        "Site_name": "djibouti_maskali_buoy_air_france",
        "ID_site": "djibouti_maskali_buoy_air_france_13",
        "year": 2022,
        "Date": "9/26/22",
        "date_iso": "2022-09-26",
        "country": "djibouti",
        "latitude_begin": 11.73536667,
        "longitude_begin": 43.16748333,
        "latitude_end": 11.73623333,
        "longitude_end": 43.16751667,
        "Substrate_1": "coral_dead",
        "Substrate_2": "branching_dead",
        "Substrate_3": "branching_dead",
        "mean": 0.003612249
    },
    {
        "id": 13,
        "Site": "djibouti_maskali",
        "Site_name": "djibouti_maskali_buoy_air_france",
        "ID_site": "djibouti_maskali_buoy_air_france_13",
        "year": 2022,
        "Date": "9/26/22",
        "date_iso": "2022-09-26",
        "country": "djibouti",
        "latitude_begin": 11.73536667,
        "longitude_begin": 43.16748333,
        "latitude_end": 11.73623333,
        "longitude_end": 43.16751667,
        "Substrate_1": "coral_alive",
        "Substrate_2": "branching_alive",
        "Substrate_3": "branching_alive",
        "mean": 0.001490278
    },
    {
        "id": 13,
        "Site": "djibouti_maskali",
        "Site_name": "djibouti_maskali_buoy_air_france",
        "ID_site": "djibouti_maskali_buoy_air_france_13",
        "year": 2022,
        "Date": "9/26/22",
        "date_iso": "2022-09-26",
        "country": "djibouti",
        "latitude_begin": 11.73536667,
        "longitude_begin": 43.16748333,
        "latitude_end": 11.73623333,
        "longitude_end": 43.16751667,
        "Substrate_1": "coral_alive",
        "Substrate_2": "branching_alive",
        "Substrate_3": "stylophora_alive",
        "mean": 0
    },
    {
        "id": 13,
        "Site": "djibouti_maskali",
        "Site_name": "djibouti_maskali_buoy_air_france",
        "ID_site": "djibouti_maskali_buoy_air_france_13",
        "year": 2022,
        "Date": "9/26/22",
        "date_iso": "2022-09-26",
        "country": "djibouti",
        "latitude_begin": 11.73536667,
        "longitude_begin": 43.16748333,
        "latitude_end": 11.73623333,
        "longitude_end": 43.16751667,
        "Substrate_1": "coral_alive",
        "Substrate_2": "branching_alive",
        "Substrate_3": "pocillopora_alive",
        "mean": 0.023564977
    },
    {
        "id": 13,
        "Site": "djibouti_maskali",
        "Site_name": "djibouti_maskali_buoy_air_france",
        "ID_site": "djibouti_maskali_buoy_air_france_13",
        "year": 2022,
        "Date": "9/26/22",
        "date_iso": "2022-09-26",
        "country": "djibouti",
        "latitude_begin": 11.73536667,
        "longitude_begin": 43.16748333,
        "latitude_end": 11.73623333,
        "longitude_end": 43.16751667,
        "Substrate_1": "coral_alive",
        "Substrate_2": "branching_alive",
        "Substrate_3": "acropora_alive",
        "mean": 0.000877899
    },
    {
        "id": 13,
        "Site": "djibouti_maskali",
        "Site_name": "djibouti_maskali_buoy_air_france",
        "ID_site": "djibouti_maskali_buoy_air_france_13",
        "year": 2022,
        "Date": "9/26/22",
        "date_iso": "2022-09-26",
        "country": "djibouti",
        "latitude_begin": 11.73536667,
        "longitude_begin": 43.16748333,
        "latitude_end": 11.73623333,
        "longitude_end": 43.16751667,
        "Substrate_1": "coral_alive",
        "Substrate_2": "branching_alive",
        "Substrate_3": "table_acropora_alive",
        "mean": 0
    },
    {
        "id": 13,
        "Site": "djibouti_maskali",
        "Site_name": "djibouti_maskali_buoy_air_france",
        "ID_site": "djibouti_maskali_buoy_air_france_13",
        "year": 2022,
        "Date": "9/26/22",
        "date_iso": "2022-09-26",
        "country": "djibouti",
        "latitude_begin": 11.73536667,
        "longitude_begin": 43.16748333,
        "latitude_end": 11.73623333,
        "longitude_end": 43.16751667,
        "Substrate_1": "coral_dead",
        "Substrate_2": "branching_dead",
        "Substrate_3": "table_acropora_dead",
        "mean": 0
    },
    {
        "id": 13,
        "Site": "djibouti_maskali",
        "Site_name": "djibouti_maskali_buoy_air_france",
        "ID_site": "djibouti_maskali_buoy_air_france_13",
        "year": 2022,
        "Date": "9/26/22",
        "date_iso": "2022-09-26",
        "country": "djibouti",
        "latitude_begin": 11.73536667,
        "longitude_begin": 43.16748333,
        "latitude_end": 11.73623333,
        "longitude_end": 43.16751667,
        "Substrate_1": "coral_alive",
        "Substrate_2": "branching_alive",
        "Substrate_3": "millepora_alive",
        "mean": 0
    },
    {
        "id": 13,
        "Site": "djibouti_maskali",
        "Site_name": "djibouti_maskali_buoy_air_france",
        "ID_site": "djibouti_maskali_buoy_air_france_13",
        "year": 2022,
        "Date": "9/26/22",
        "date_iso": "2022-09-26",
        "country": "djibouti",
        "latitude_begin": 11.73536667,
        "longitude_begin": 43.16748333,
        "latitude_end": 11.73623333,
        "longitude_end": 43.16751667,
        "Substrate_1": "coral_alive",
        "Substrate_2": "massive/meandering_alive",
        "Substrate_3": "turbinaria_alive",
        "mean": 0
    },
    {
        "id": 13,
        "Site": "djibouti_maskali",
        "Site_name": "djibouti_maskali_buoy_air_france",
        "ID_site": "djibouti_maskali_buoy_air_france_13",
        "year": 2022,
        "Date": "9/26/22",
        "date_iso": "2022-09-26",
        "country": "djibouti",
        "latitude_begin": 11.73536667,
        "longitude_begin": 43.16748333,
        "latitude_end": 11.73623333,
        "longitude_end": 43.16751667,
        "Substrate_1": "coral_bleached",
        "Substrate_2": "other_coral_bleached",
        "Substrate_3": "other_coral_bleached",
        "mean": 0
    },
    {
        "id": 13,
        "Site": "djibouti_maskali",
        "Site_name": "djibouti_maskali_buoy_air_france",
        "ID_site": "djibouti_maskali_buoy_air_france_13",
        "year": 2022,
        "Date": "9/26/22",
        "date_iso": "2022-09-26",
        "country": "djibouti",
        "latitude_begin": 11.73536667,
        "longitude_begin": 43.16748333,
        "latitude_end": 11.73623333,
        "longitude_end": 43.16751667,
        "Substrate_1": "coral_dead",
        "Substrate_2": "other_coral_dead",
        "Substrate_3": "other_coral_dead",
        "mean": 0
    },
    {
        "id": 13,
        "Site": "djibouti_maskali",
        "Site_name": "djibouti_maskali_buoy_air_france",
        "ID_site": "djibouti_maskali_buoy_air_france_13",
        "year": 2022,
        "Date": "9/26/22",
        "date_iso": "2022-09-26",
        "country": "djibouti",
        "latitude_begin": 11.73536667,
        "longitude_begin": 43.16748333,
        "latitude_end": 11.73623333,
        "longitude_end": 43.16751667,
        "Substrate_1": "coral_alive",
        "Substrate_2": "other_coral_alive",
        "Substrate_3": "other_coral_alive",
        "mean": 0.010435467
    },
    {
        "id": 13,
        "Site": "djibouti_maskali",
        "Site_name": "djibouti_maskali_buoy_air_france",
        "ID_site": "djibouti_maskali_buoy_air_france_13",
        "year": 2022,
        "Date": "9/26/22",
        "date_iso": "2022-09-26",
        "country": "djibouti",
        "latitude_begin": 11.73536667,
        "longitude_begin": 43.16748333,
        "latitude_end": 11.73623333,
        "longitude_end": 43.16751667,
        "Substrate_1": "coral_alive",
        "Substrate_2": "massive/meandering_alive",
        "Substrate_3": "massive/meandering_alive",
        "mean": 0.097893604
    },
    {
        "id": 13,
        "Site": "djibouti_maskali",
        "Site_name": "djibouti_maskali_buoy_air_france",
        "ID_site": "djibouti_maskali_buoy_air_france_13",
        "year": 2022,
        "Date": "9/26/22",
        "date_iso": "2022-09-26",
        "country": "djibouti",
        "latitude_begin": 11.73536667,
        "longitude_begin": 43.16748333,
        "latitude_end": 11.73623333,
        "longitude_end": 43.16751667,
        "Substrate_1": "coral_dead",
        "Substrate_2": "massive/meandering_dead",
        "Substrate_3": "massive/meandering_dead",
        "mean": 0.003032376
    },
    {
        "id": 13,
        "Site": "djibouti_maskali",
        "Site_name": "djibouti_maskali_buoy_air_france",
        "ID_site": "djibouti_maskali_buoy_air_france_13",
        "year": 2022,
        "Date": "9/26/22",
        "date_iso": "2022-09-26",
        "country": "djibouti",
        "latitude_begin": 11.73536667,
        "longitude_begin": 43.16748333,
        "latitude_end": 11.73623333,
        "longitude_end": 43.16751667,
        "Substrate_1": "coral_bleached",
        "Substrate_2": "massive/meandering_bleached",
        "Substrate_3": "massive/meandering_bleached",
        "mean": 0.00029531
    },
    {
        "id": 13,
        "Site": "djibouti_maskali",
        "Site_name": "djibouti_maskali_buoy_air_france",
        "ID_site": "djibouti_maskali_buoy_air_france_13",
        "year": 2022,
        "Date": "9/26/22",
        "date_iso": "2022-09-26",
        "country": "djibouti",
        "latitude_begin": 11.73536667,
        "longitude_begin": 43.16748333,
        "latitude_end": 11.73623333,
        "longitude_end": 43.16751667,
        "Substrate_1": "coral_alive",
        "Substrate_2": "meandering_alive",
        "Substrate_3": "meandering_alive",
        "mean": 0.015330757
    },
    {
        "id": 13,
        "Site": "djibouti_maskali",
        "Site_name": "djibouti_maskali_buoy_air_france",
        "ID_site": "djibouti_maskali_buoy_air_france_13",
        "year": 2022,
        "Date": "9/26/22",
        "date_iso": "2022-09-26",
        "country": "djibouti",
        "latitude_begin": 11.73536667,
        "longitude_begin": 43.16748333,
        "latitude_end": 11.73623333,
        "longitude_end": 43.16751667,
        "Substrate_1": "coral_dead",
        "Substrate_2": "meandering_dead",
        "Substrate_3": "meandering_dead",
        "mean": 0
    },
    {
        "id": 13,
        "Site": "djibouti_maskali",
        "Site_name": "djibouti_maskali_buoy_air_france",
        "ID_site": "djibouti_maskali_buoy_air_france_13",
        "year": 2022,
        "Date": "9/26/22",
        "date_iso": "2022-09-26",
        "country": "djibouti",
        "latitude_begin": 11.73536667,
        "longitude_begin": 43.16748333,
        "latitude_end": 11.73623333,
        "longitude_end": 43.16751667,
        "Substrate_1": "coral_bleached",
        "Substrate_2": "meandering_bleached",
        "Substrate_3": "meandering_bleached",
        "mean": 0
    },
    {
        "id": 13,
        "Site": "djibouti_maskali",
        "Site_name": "djibouti_maskali_buoy_air_france",
        "ID_site": "djibouti_maskali_buoy_air_france_13",
        "year": 2022,
        "Date": "9/26/22",
        "date_iso": "2022-09-26",
        "country": "djibouti",
        "latitude_begin": 11.73536667,
        "longitude_begin": 43.16748333,
        "latitude_end": 11.73623333,
        "longitude_end": 43.16751667,
        "Substrate_1": "other_invertebrates",
        "Substrate_2": "sea_urchin",
        "Substrate_3": "sea_urchin",
        "mean": 0
    },
    {
        "id": 13,
        "Site": "djibouti_maskali",
        "Site_name": "djibouti_maskali_buoy_air_france",
        "ID_site": "djibouti_maskali_buoy_air_france_13",
        "year": 2022,
        "Date": "9/26/22",
        "date_iso": "2022-09-26",
        "country": "djibouti",
        "latitude_begin": 11.73536667,
        "longitude_begin": 43.16748333,
        "latitude_end": 11.73623333,
        "longitude_end": 43.16751667,
        "Substrate_1": "other_invertebrates",
        "Substrate_2": "sea_cucumber",
        "Substrate_3": "sea_cucumber",
        "mean": 0
    },
    {
        "id": 13,
        "Site": "djibouti_maskali",
        "Site_name": "djibouti_maskali_buoy_air_france",
        "ID_site": "djibouti_maskali_buoy_air_france_13",
        "year": 2022,
        "Date": "9/26/22",
        "date_iso": "2022-09-26",
        "country": "djibouti",
        "latitude_begin": 11.73536667,
        "longitude_begin": 43.16748333,
        "latitude_end": 11.73623333,
        "longitude_end": 43.16751667,
        "Substrate_1": "anemone",
        "Substrate_2": "anemone",
        "Substrate_3": "anemone",
        "mean": 0.001302392
    },
    {
        "id": 13,
        "Site": "djibouti_maskali",
        "Site_name": "djibouti_maskali_buoy_air_france",
        "ID_site": "djibouti_maskali_buoy_air_france_13",
        "year": 2022,
        "Date": "9/26/22",
        "date_iso": "2022-09-26",
        "country": "djibouti",
        "latitude_begin": 11.73536667,
        "longitude_begin": 43.16748333,
        "latitude_end": 11.73623333,
        "longitude_end": 43.16751667,
        "Substrate_1": "other_invertebrates",
        "Substrate_2": "sponge",
        "Substrate_3": "sponge",
        "mean": 0.000637084
    },
    {
        "id": 13,
        "Site": "djibouti_maskali",
        "Site_name": "djibouti_maskali_buoy_air_france",
        "ID_site": "djibouti_maskali_buoy_air_france_13",
        "year": 2022,
        "Date": "9/26/22",
        "date_iso": "2022-09-26",
        "country": "djibouti",
        "latitude_begin": 11.73536667,
        "longitude_begin": 43.16748333,
        "latitude_end": 11.73623333,
        "longitude_end": 43.16751667,
        "Substrate_1": "other_invertebrates",
        "Substrate_2": "clam",
        "Substrate_3": "clam",
        "mean": 0.001902114
    },
    {
        "id": 13,
        "Site": "djibouti_maskali",
        "Site_name": "djibouti_maskali_buoy_air_france",
        "ID_site": "djibouti_maskali_buoy_air_france_13",
        "year": 2022,
        "Date": "9/26/22",
        "date_iso": "2022-09-26",
        "country": "djibouti",
        "latitude_begin": 11.73536667,
        "longitude_begin": 43.16748333,
        "latitude_end": 11.73623333,
        "longitude_end": 43.16751667,
        "Substrate_1": "other_animal",
        "Substrate_2": "other_animal",
        "Substrate_3": "other_animal",
        "mean": 0
    },
    {
        "id": 13,
        "Site": "djibouti_maskali",
        "Site_name": "djibouti_maskali_buoy_air_france",
        "ID_site": "djibouti_maskali_buoy_air_france_13",
        "year": 2022,
        "Date": "9/26/22",
        "date_iso": "2022-09-26",
        "country": "djibouti",
        "latitude_begin": 11.73536667,
        "longitude_begin": 43.16748333,
        "latitude_end": 11.73623333,
        "longitude_end": 43.16751667,
        "Substrate_1": "trash",
        "Substrate_2": "trash",
        "Substrate_3": "trash",
        "mean": 0
    },
    {
        "id": 13,
        "Site": "djibouti_maskali",
        "Site_name": "djibouti_maskali_buoy_air_france",
        "ID_site": "djibouti_maskali_buoy_air_france_13",
        "year": 2022,
        "Date": "9/26/22",
        "date_iso": "2022-09-26",
        "country": "djibouti",
        "latitude_begin": 11.73536667,
        "longitude_begin": 43.16748333,
        "latitude_end": 11.73623333,
        "longitude_end": 43.16751667,
        "Substrate_1": "other_invertebrates",
        "Substrate_2": "seagrass",
        "Substrate_3": "seagrass",
        "mean": 0
    }
];


const validSubstrates = [
          'sand',
          'rubble',
          'unknown_hard_substrate',
          'algae_covered_substrate',
          'coral_bleached',
          'coral_dead',
          'coral_alive',
          'other_invertebrates',
          'anemone',
          'other_animal',
          'trash'
        ];
        
 const colorPalette = [
        '#d4b483',
        '#a39081',
        '#828282',
        '#5b7065',
        '#fff1af',
        '#8b6b61',
        '#5c8374',
        '#9db2bf',
        '#526d82',
        '#27374d',
        '#000000'
      ];

        
        const seriesData = {};
function processData(data) {

        // init to 0
        validSubstrates.forEach((substrate) => {
          seriesData[substrate] = 0;
        });

        data.forEach((item) => {
          if (validSubstrates.includes(item.Substrate_1)) {
            seriesData[item.Substrate_1] += item.mean;
          }
        });

        return validSubstrates.map((substrate, index) => ({
          name: substrate,
          value: seriesData[substrate],
          itemStyle: {
            color: colorPalette[index]
          },
        }));
      }

option = {
  xAxis: {
    type: 'category',
    data: validSubstrates,
    name: 'substrate'
  },
  legend: {
          data: validSubstrates,
          type: 'scroll',
          orient: 'horizontal',
          bottom: 0
        },
  yAxis: {
    type: 'value',
    name: 'Percentage',
            axisLabel: {
            formatter: function(value) {
              return (value * 100) + '%';
            }
            },
          max: 1,
          min: 0
  },
  series: [
    {
      data: processData(rawData),
      type: 'bar'
    }
  ]
};